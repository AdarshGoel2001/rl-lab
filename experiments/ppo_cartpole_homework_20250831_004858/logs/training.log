2025-08-31 00:48:58,341 - src.core.trainer - INFO - Logging setup complete. Log file: experiments/ppo_cartpole_homework_20250831_004858/logs/training.log
2025-08-31 00:48:58,342 - src.utils.registry - INFO - Registered algorithm: ppo -> PPOAlgorithm
2025-08-31 00:48:58,342 - src.utils.registry - INFO - Registered algorithm: random -> RandomAgent
2025-08-31 00:48:58,344 - src.utils.registry - INFO - Registered network: mlp -> MLP
2025-08-31 00:48:58,344 - src.utils.registry - INFO - Registered network: actor_mlp -> ActorMLP
2025-08-31 00:48:58,344 - src.utils.registry - INFO - Registered network: critic_mlp -> CriticMLP
2025-08-31 00:48:58,344 - src.utils.registry - INFO - Registered network: continuous_actor_mlp -> ContinuousActorMLP
2025-08-31 00:48:58,344 - src.utils.registry - INFO - Registered network: dueling_mlp -> DuelingMLP
2025-08-31 00:48:58,345 - src.utils.registry - INFO - Registered environment: gym -> GymWrapper
2025-08-31 00:48:58,346 - src.utils.registry - INFO - Registered buffer: trajectory -> TrajectoryBuffer
2025-08-31 00:48:58,346 - src.core.trainer - INFO - Initializing environment...
2025-08-31 00:48:58,385 - src.environments.gym_wrapper - INFO - Created Gym environment: CartPole-v1
2025-08-31 00:48:58,385 - src.core.trainer - INFO - Environment: CartPole-v1
2025-08-31 00:48:58,385 - src.core.trainer - INFO - Observation space: (4,)
2025-08-31 00:48:58,385 - src.core.trainer - INFO - Action space: (np.int64(2),), discrete: True
2025-08-31 00:48:58,385 - src.core.trainer - INFO - Initializing networks...
2025-08-31 00:48:58,406 - src.core.trainer - INFO - Created actor network: actor_mlp
2025-08-31 00:48:58,406 - src.core.trainer - INFO - Created critic network: critic_mlp
2025-08-31 00:48:58,406 - src.core.trainer - INFO - Initializing algorithm...
2025-08-31 00:48:58,968 - src.core.trainer - INFO - Created algorithm: ppo
2025-08-31 00:48:58,969 - src.core.trainer - INFO - Initializing buffer...
2025-08-31 00:48:58,969 - src.core.trainer - INFO - Created buffer: trajectory
2025-08-31 00:48:58,975 - src.environments.gym_wrapper - INFO - Seed will be applied on next reset: 42
2025-08-31 00:48:58,975 - src.core.trainer - INFO - Random seeds set to 42
2025-08-31 00:48:58,975 - src.core.trainer - INFO - All components initialized successfully
2025-08-31 00:48:58,975 - src.utils.checkpoint - INFO - Checkpoint manager initialized at experiments/ppo_cartpole_homework_20250831_004858/checkpoints
2025-08-31 00:48:58,977 - src.utils.logger - INFO - TensorBoard logging enabled: experiments/ppo_cartpole_homework_20250831_004858/tensorboard
2025-08-31 00:49:00,936 - src.utils.logger - INFO - W&B logging enabled: https://wandb.ai/adarshgoel-rl-lab/rl-lab-homework/runs/r0v7ig9l
2025-08-31 00:49:00,936 - src.utils.logger - INFO - Experiment logger initialized: experiments/ppo_cartpole_homework_20250831_004858
2025-08-31 00:49:00,936 - src.utils.checkpoint - INFO - No checkpoint found to load
2025-08-31 00:49:00,936 - src.core.trainer - INFO - No checkpoint found, starting from scratch
2025-08-31 00:49:00,936 - src.core.trainer - INFO - Trainer initialized for experiment: ppo_cartpole_homework
2025-08-31 00:49:00,936 - src.core.trainer - INFO - Experiment directory: experiments/ppo_cartpole_homework_20250831_004858
2025-08-31 00:49:00,938 - src.utils.config - INFO - Configuration saved to experiments/ppo_cartpole_homework_20250831_004858/configs/config.yaml
2025-08-31 00:49:00,948 - src.core.trainer - INFO - Experiment config saved to experiments/ppo_cartpole_homework_20250831_004858/configs/config.yaml
2025-08-31 00:49:00,949 - __main__ - INFO - Experiment directory: experiments/ppo_cartpole_homework_20250831_004858
2025-08-31 00:49:00,949 - __main__ - INFO - Configuration hash: 820f520e
2025-08-31 00:49:00,949 - __main__ - INFO - Starting training loop...
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Starting training...
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Target steps: 100
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Evaluation frequency: 5000
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Checkpoint frequency: 10000
2025-08-31 00:49:00,967 - src.core.trainer - ERROR - Training failed: Tensor for argument weight is on cpu but expected on mps
2025-08-31 00:49:00,971 - src.core.trainer - ERROR - Full traceback:
Traceback (most recent call last):
  File "/Users/martian/Documents/Code/rl-lab/src/core/trainer.py", line 285, in train
    self._training_step()
  File "/Users/martian/Documents/Code/rl-lab/src/core/trainer.py", line 372, in _training_step
    trajectory = self._collect_experience()
  File "/Users/martian/Documents/Code/rl-lab/src/core/trainer.py", line 433, in _collect_experience
    action, log_prob, value = self.algorithm.get_action_and_value(obs_tensor)
  File "/Users/martian/Documents/Code/rl-lab/src/algorithms/ppo.py", line 217, in get_action_and_value
    actor_output = self.networks['actor'](observation)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/martian/Documents/Code/rl-lab/src/networks/mlp.py", line 134, in forward
    x = self.layers(x)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: Tensor for argument weight is on cpu but expected on mps

2025-08-31 00:49:00,973 - src.utils.checkpoint - INFO - Checkpoint saved: experiments/ppo_cartpole_homework_20250831_004858/checkpoints/error.pt (step 0)
2025-08-31 00:49:00,974 - src.core.trainer - INFO - Emergency checkpoint saved
2025-08-31 00:49:00,974 - src.utils.logger - INFO - TensorBoard writer closed
2025-08-31 00:49:03,370 - src.utils.logger - INFO - W&B run finished
2025-08-31 00:49:03,370 - __main__ - ERROR - Training failed: Tensor for argument weight is on cpu but expected on mps
2025-08-31 00:49:03,371 - src.core.trainer - INFO - Trainer cleanup completed
