2025-08-31 00:49:00,936 - src.utils.logger - INFO - W&B logging enabled: https://wandb.ai/adarshgoel-rl-lab/rl-lab-homework/runs/r0v7ig9l
2025-08-31 00:49:00,936 - src.utils.logger - INFO - Experiment logger initialized: experiments/ppo_cartpole_homework_20250831_004858
2025-08-31 00:49:00,936 - src.utils.checkpoint - INFO - No checkpoint found to load
2025-08-31 00:49:00,936 - src.core.trainer - INFO - No checkpoint found, starting from scratch
2025-08-31 00:49:00,936 - src.core.trainer - INFO - Trainer initialized for experiment: ppo_cartpole_homework
2025-08-31 00:49:00,936 - src.core.trainer - INFO - Experiment directory: experiments/ppo_cartpole_homework_20250831_004858
2025-08-31 00:49:00,938 - src.utils.config - INFO - Configuration saved to experiments/ppo_cartpole_homework_20250831_004858/configs/config.yaml
2025-08-31 00:49:00,948 - src.core.trainer - INFO - Experiment config saved to experiments/ppo_cartpole_homework_20250831_004858/configs/config.yaml
2025-08-31 00:49:00,949 - __main__ - INFO - Experiment directory: experiments/ppo_cartpole_homework_20250831_004858
2025-08-31 00:49:00,949 - __main__ - INFO - Configuration hash: 820f520e
2025-08-31 00:49:00,949 - __main__ - INFO - Starting training loop...
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Starting training...
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Target steps: 100
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Evaluation frequency: 5000
2025-08-31 00:49:00,949 - src.core.trainer - INFO - Checkpoint frequency: 10000
2025-08-31 00:49:00,967 - src.core.trainer - ERROR - Training failed: Tensor for argument weight is on cpu but expected on mps
2025-08-31 00:49:00,971 - src.core.trainer - ERROR - Full traceback:
Traceback (most recent call last):
  File "/Users/martian/Documents/Code/rl-lab/src/core/trainer.py", line 285, in train
    self._training_step()
  File "/Users/martian/Documents/Code/rl-lab/src/core/trainer.py", line 372, in _training_step
    trajectory = self._collect_experience()
  File "/Users/martian/Documents/Code/rl-lab/src/core/trainer.py", line 433, in _collect_experience
    action, log_prob, value = self.algorithm.get_action_and_value(obs_tensor)
  File "/Users/martian/Documents/Code/rl-lab/src/algorithms/ppo.py", line 217, in get_action_and_value
    actor_output = self.networks['actor'](observation)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/martian/Documents/Code/rl-lab/src/networks/mlp.py", line 134, in forward
    x = self.layers(x)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/martian/miniconda3/envs/rl-lab/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: Tensor for argument weight is on cpu but expected on mps

2025-08-31 00:49:00,973 - src.utils.checkpoint - INFO - Checkpoint saved: experiments/ppo_cartpole_homework_20250831_004858/checkpoints/error.pt (step 0)
2025-08-31 00:49:00,974 - src.core.trainer - INFO - Emergency checkpoint saved
2025-08-31 00:49:00,974 - src.utils.logger - INFO - TensorBoard writer closed
